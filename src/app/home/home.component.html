<tour-step-template></tour-step-template>
<div class="container-fluid">
  <div class="row">
    <div class="col-md-2 col-xs-12" style="padding-left: 0px; cursor: pointer;" [routerLink]="['']" tourAnchor="home.start.tour" >
      <img src="scorecard.svg" style="height: 58px; width: 48px" > <span style="font-size: 20px"> Score Card</span>
    </div>
    <div class="col-md-8 col-xs-12" style="margin-top: 14px">
      <input
        tourAnchor="home.search"
        type="search"
        class="form-control input-sm"
        placeholder="Search score card by name"
        [(ngModel)]="queryterm">
    </div>
    <div class="col-md-2 col-xs-12 hidden-sm" style="margin-top: 14px">
      <button tourAnchor="home.create" style="height: 34px" class="btn btn-outline-secondary btn-sm float-md-right cursor" [routerLink]="['create','new','0']">
        <i class="fa fa-plus" aria-hidden="true"></i> Create
      </button>
      <button
        style="height: 34px;margin-right: 3px"
        class="btn btn-outline-secondary btn-sm float-md-right cursor"
        title="{{viewTitle}}"
        (click)="changeView()"
        tourAnchor="home.listview"
      >
        <i class="fa fa-list" *ngIf="viewStle == 'Thumbnail'"></i>
        <i class="fa fa-th-large" *ngIf="viewStle == 'List'"></i>
        <i class="fa fa-th" *ngIf="viewStle == 'Card'"></i>
      </button>
      <button
        style="height: 34px;margin-right: 3px"
        class="btn btn-outline-secondary btn-sm float-md-right cursor"
        title="Get help"
        (click)="startTour()"
      >
        <i class="fa fa-question-circle"></i>
      </button>
    </div>
  </div>
</div>
<!--if there is no scorecard created-->
<!--<div class="container-fluid" style="padding-left: 0px; border-top: 1px solid blanchedalmond; margin-top: 20px; padding-top: 23px">-->
<div class="container-fluid" style="padding-left: 0px; border-top: 1px solid blanchedalmond;margin-top: 15px" *ngIf="(scorecards$ | async).length == 0 && !(scorecards_loading$ | async)">
  <div class="jumbotron" style="background-color: transparent" >
    <h1 class="display-3">Welcome to Scorecard App!</h1>
    <p class="lead">Create a score card instantly, over tea break...</p>
    <hr class="my-4">
    <ol style="margin-left:20px;">
      <li style="padding:2px;">Click create new, Write your score card a title and description</li>
      <li style="padding:2px;">Write group header name for indicators you will create in next step</li>
      <li style="padding:2px;">Select indicator group and click indicator to add to the group
        <ul style="margin-left:20px;">
          <li style="padding:2px;">Edit title to change title to use on heading</li>
          <li style="padding:2px;">Enter effective gap to show increase/decrease from last period</li>
          <li style="padding:2px;">Set minimum and maximum range for each color code</li>
        </ul>
      </li>
      <li style="padding:2px;">Click "Add another" to add another indicator in next column in the group</li>
      <li style="padding:2px;">Select the second indicator to add indicator in the same group</li>
      <li style="padding:2px;">Click "Add another" in Group row to add next group</li>
    </ol>
    <p><a class="btn btn-outline-primary btn-lg" href="#" role="button" [routerLink]="['create','new','0']" *ngIf="have_authorities">New Scorecard</a></p>
  </div>
</div>

<!--if the scorecards are being loaded-->
<div
  class="container-fluid"
  style="padding-left: 0px; border-top: 1px solid blanchedalmond; margin-top: 20px; padding-top: 23px"
  *ngIf="(scorecards$ | async).length == 0 && (scorecards_loading$ | async)"
>
  <div class="well well-lg ">
    <h5 class="text-center"><img src="balls-3.svg" style="height: 70px"/> Loading score cards...</h5>
    <app-placeholder></app-placeholder>
  </div>
</div>


<div
  class="container-fluid"
  style="padding-top: 20px;padding-left: 0px; border-top: 1px solid blanchedalmond; margin-top: 20px; padding-top: 23px"
  *ngIf="(scorecards$ | async).length != 0" >
  <div [@hiddenItem] = "(scorecards_loading$ | async)?'notHidden':'hidden'">
    <h5 class="text-center"><img src="balls-3.svg" style="height: 70px"/>
      Loading score cards( {{ complete_percent$ | async }}% )
    </h5>
    <div class="progress" style="margin-bottom: 5px">
      <div
        class="progress-bar progress-bar-striped progress-bar-animated"
        role="progressbar"
        [attr.aria-valuenow]="complete_percent$ | async"
        [attr.aria-valuemin]="0"
        [attr.aria-valuemax]="100"
        [style.width]="(complete_percent$ | async)+'%'"
      ></div>
    </div>
  </div>

  <div *ngIf="viewStle == 'Card'">
    <div class="card-deck">
      <div
        class="card scorecard_details col-sm-12 col-md-4 text-center cursor"
        *ngFor="let scorecard of (scorecards$ | async) | scoreCardFilter: queryterm | paginate: config "
        [@visibilityChanged]="scorecard.hoverState || 'notHovered'"
        (mouseenter) ="mouseEnter(scorecard)"
        (mouseleave) ="mouseLeave(scorecard)"
        (click)="viewcorecard(scorecard,$event)"
      >
        <h1 class="text-center text-muted"><img src="assets/img/scorecardplaceholder.jpg" style="height: 120px"> </h1>
        <!--<img class="card-img-top" src="assets/img/scorecardplaceholder.jpg" style="height: 160px; width: 280px;margin-right: 20%" alt="{{ scorecard.data.header.title }}">-->
        <div class="card-body">
          <h4 class="card-title text-center">{{ scorecard.data.header.title }}</h4>
          <p class="lead text-center">{{ scorecard.data.header.description }}</p>


        </div>
        <div class="card-footer" style="border-top: 0px;background-color: rgba(0,0,0,0.0)">
          <h1 class="text-center" *ngIf="!scorecard.confirm_deleting && !scorecard.deleting && !scorecard.error_deleting">
            <a
              style="cursor: pointer"
              class="btn btn-outline-primary sans-pro"
              role="button"
              title="Open {{ scorecard.data.header.title }}">
              View
            </a>
            <a  *ngIf="scorecard.can_edit" title="edit {{ scorecard.data.header.title }}"
                (click)="openscorecard(scorecard,$event)"
                class="btn btn-outline-info sans-pro"
                role="button"
                style="cursor: pointer"
            >
              <i class="fa fa-pencil text-primary"></i>
            </a>
            <button
              *ngIf="scorecard.can_edit"
              title="delete {{ scorecard.data.header.title }}"
              (click)="scorecard.confirm_deleting = true; $event.stopPropagation()"
              class="btn btn-outline-dark sans-pro"
              role="button"
              style="cursor: pointer"
            >
              <i class="fa fa-trash-o text-danger"></i>
            </button>
          </h1>
          <p class="icons" *ngIf="scorecard.confirm_deleting" style="padding: 5px; font-size: 12px"> Are you sure you want to delete this score card?
            <button class="btn btn-sm btn-outline-danger cursor" (click)="deleteScoreCard(scorecard,$event)">Delete</button>
            <button class="btn btn-sm btn-outline-success cursor" (click)="scorecard.confirm_deleting = false; $event.stopPropagation()">Cancel</button>
          </p>

          <p class="icons" *ngIf="scorecard.deleting" style="padding: 5px; font-size: 12px">
            <img src="balls-5.svg" style="height: 50px;"> Deleting Scorecard...
          </p>
          <p class="icons text-danger" *ngIf="scorecard.error_deleting" style="padding: 5px; font-size: 12px">
            Something went wrong, Scorecard was not deleted
          </p>
        </div>
      </div>
    </div>

    <div class="row justify-content-center" style="margin-top: 25px">
      <pagination-template #nm="paginationApi" [id]="config.id" (pageChange)="config.currentPage = $event">
        <nav aria-label="Page navigation example">
          <ul class="pagination ">
            <li class="page-item" [class.disabled]="nm.isFirstPage()">
              <a class="page-link" style="cursor: pointer" (click)="nm.previous()" aria-label="Previous">
                <span aria-hidden="true">&laquo;</span>
                <span class="sr-only">Previous</span>
              </a>
            </li>
            <li class="page-item"
                *ngFor="let page of nm.pages"
                [class.active]="nm.getCurrent() === page.value"
            ><a class="page-link" style="cursor: pointer" (click)="nm.setCurrent(page.value)">
              {{ page.label }}
            </a></li>
            <li class="page-item" [class.disabled]="nm.isLastPage()">
              <a class="page-link" style="cursor: pointer" (click)="nm.next()" aria-label="Next">
                <span aria-hidden="true">&raquo;</span>
                <span class="sr-only">Next</span>
              </a>
            </li>
          </ul>
        </nav>
      </pagination-template>
    </div>
  </div>

  <div  *ngIf="viewStle == 'List'">
    <ul class="list-group">
      <li
        class="list-group-item cursor"
        *ngFor="let scorecard of (scorecards$ | async) | scoreCardFilter: queryterm"
        [@visibilityChanged]="scorecard.hoverState || 'notHovered'"
        (mouseenter) ="mouseEnter(scorecard)"
        (mouseleave) ="mouseLeave(scorecard)"
        (click)="viewcorecard(scorecard,$event)"
        style="padding-bottom: 40px"
      >
        <div class="row">
          <div class="col-md-3">
            <img src="assets/img/scorecardplaceholder.jpg" class="pull-left" style="height: 120px">
          </div>
          <div class="col-md-9">
            <h4 class="card-title text-left">{{ scorecard.data.header.title }}</h4>
            <p class="lead text-left">{{ scorecard.data.header.description }}</p>
            <div class="pull-left" style="border-top: 0px;background-color: rgba(0,0,0,0.0)">
              <h1 class="text-center" *ngIf="!scorecard.confirm_deleting && !scorecard.deleting && !scorecard.error_deleting">
                <a
                  style="cursor: pointer"
                  class="btn btn-outline-primary sans-pro"
                  role="button"
                  title="Open {{ scorecard.data.header.title }}">
                  View
                </a>
                <a  *ngIf="scorecard.can_edit" title="edit {{ scorecard.data.header.title }}"
                    (click)="openscorecard(scorecard,$event)"
                    class="btn btn-outline-info sans-pro"
                    role="button"
                    style="cursor: pointer"
                >
                  <i class="fa fa-pencil text-primary"></i>
                </a>
                <button
                  *ngIf="scorecard.can_edit"
                  title="delete {{ scorecard.data.header.title }}"
                  (click)="scorecard.confirm_deleting = true; $event.stopPropagation()"
                  class="btn btn-outline-dark sans-pro"
                  role="button"
                  style="cursor: pointer"
                >
                  <i class="fa fa-trash-o text-danger"></i>
                </button>
              </h1>
              <p class="icons" *ngIf="scorecard.confirm_deleting" style="padding: 5px; font-size: 12px"> Are you sure you want to delete this score card?
                <button class="btn btn-sm btn-outline-danger cursor" (click)="deleteScoreCard(scorecard,$event)">Delete</button>
                <button class="btn btn-sm btn-outline-success cursor" (click)="scorecard.confirm_deleting = false; $event.stopPropagation()">Cancel</button>
              </p>

              <p class="icons" *ngIf="scorecard.deleting" style="padding: 5px; font-size: 12px">
                <img src="balls-5.svg" style="height: 50px;"> Deleting Scorecard...
              </p>
              <p class="icons text-danger" *ngIf="scorecard.error_deleting" style="padding: 5px; font-size: 12px">
                Something went wrong, Scorecard was not deleted
              </p>
            </div>
          </div>
        </div>
      </li>
    </ul>
  </div>

  <div class="row"  *ngIf="viewStle == 'Thumbnail'">

      <div
        class="col-sm-6"
        *ngFor="let scorecard of (scorecards$ | async) | scoreCardFilter: queryterm"
        [@visibilityChanged]="scorecard.hoverState || 'notHovered'"
        (mouseenter) ="mouseEnter(scorecard)"
        (mouseleave) ="mouseLeave(scorecard)"
        (click)="viewcorecard(scorecard,$event)"
        style="padding-bottom: 40px"
      >
        <div class="row">
          <div class="col-md-4">
            <img src="assets/img/scorecardplaceholder.jpg" class="pull-left" style="height: 100px">
          </div>
          <div class="col-md-8">
            <h4 class="card-title text-left">{{ scorecard.data.header.title }}</h4>
            <p class="lead text-left">{{ scorecard.data.header.description }}</p>
            <div class="pull-left" style="border-top: 0px;background-color: rgba(0,0,0,0.0)">
              <h1 class="text-center" *ngIf="!scorecard.confirm_deleting && !scorecard.deleting && !scorecard.error_deleting">
                <a
                  style="cursor: pointer"
                  class="btn btn-outline-primary sans-pro"
                  role="button"
                  title="Open {{ scorecard.data.header.title }}">
                  View
                </a>
                <a  *ngIf="scorecard.can_edit" title="edit {{ scorecard.data.header.title }}"
                    (click)="openscorecard(scorecard,$event)"
                    class="btn btn-outline-info sans-pro"
                    role="button"
                    style="cursor: pointer"
                >
                  <i class="fa fa-pencil text-primary"></i>
                </a>
                <button
                  *ngIf="scorecard.can_edit"
                  title="delete {{ scorecard.data.header.title }}"
                  (click)="scorecard.confirm_deleting = true; $event.stopPropagation()"
                  class="btn btn-outline-dark sans-pro"
                  role="button"
                  style="cursor: pointer"
                >
                  <i class="fa fa-trash-o text-danger"></i>
                </button>
              </h1>
              <p class="icons" *ngIf="scorecard.confirm_deleting" style="padding: 5px; font-size: 12px"> Are you sure you want to delete this score card?
                <button class="btn btn-sm btn-outline-danger cursor" (click)="deleteScoreCard(scorecard,$event)">Delete</button>
                <button class="btn btn-sm btn-outline-success cursor" (click)="scorecard.confirm_deleting = false; $event.stopPropagation()">Cancel</button>
              </p>

              <p class="icons" *ngIf="scorecard.deleting" style="padding: 5px; font-size: 12px">
                <img src="balls-5.svg" style="height: 50px;"> Deleting Scorecard...
              </p>
              <p class="icons text-danger" *ngIf="scorecard.error_deleting" style="padding: 5px; font-size: 12px">
                Something went wrong, Scorecard was not deleted
              </p>
            </div>
          </div>
        </div>
      </div>
  </div>

  </div>




